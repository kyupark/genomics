//============================================================================
// Name        : TeaQ.cpp
// Author      :
// Version     :
// Copyright   : Your copyright notice
// Description : Hello World in C++, Ansi-style
//============================================================================

// #include <iostream>
//#include <bwtaln.h>
#include "ReadClipper.hpp"


using namespace TeaQ;
using namespace std;

int main(int argc, char *argv[]) {
	if (argc < 2) {
		cerr << "usage: " << argv[0] << " <filename> " << endl;\
		cerr << "usage: " << argv[0] << " <filename> <ref family file>" << endl;
		cerr << "usage: " << argv[0] << " <filename> <ref family file> <minimum read length = 5>" << endl;
		cerr << "usage: " << argv[0] << " <filename> <ref family file> <minimum read length = 5> <minimum base gap = 2>" << endl;
		cerr << "usage: " << argv[0] << " <filename> <ref family file> <minimum read length = 5> <minimum base gap = 2> <cap3_options = -i 21 -j 31 -o 16 -s 251 -p 70>" << endl;
		return 1;
	}
	string bam_file_name = argv[1];
//	string bam_file_name = "/home/el114/kyu/data/test.bam";
	string ref_family_name =
	"/home/el114/kyu/data/bwa_idx/human_youngTE_revisedPolyA.fa"
//	ReadClipper::clip_filter_sort(bam_file_name, 5, 2);

	ReadClipper::clip_filter_contiggen(
			bam_file_name,
			"/home/el114/kyu/data/bwa_idx/human_youngTE_revisedPolyA.fa",
			5, // minimum_read_length = 5,
			2, // minimum_base_gap = 2,
			"-i 21 -j 31 -o 16 -s 251 -p 70");
				// cap3_options = "-i 21 -j 31 -o 16 -s 251 -p 70");

	return 0;
}
